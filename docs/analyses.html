<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="431 Staff">
<meta name="dcterms.date" content="2023-08-21">

<title>431 Project A - Project A Analyses</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">431 Project A</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data.html" rel="" target="">
 <span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./proposal.html" rel="" target="">
 <span class="menu-text">Proposal</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./analyses.html" rel="" target="" aria-current="page">
 <span class="menu-text">Analyses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./portfolio.html" rel="" target="">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./examples.html" rel="" target="">
 <span class="menu-text">Examples</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://thomaselove.github.io/431-2023/contact.html" rel="" target="">
 <span class="menu-text">Contact Us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://thomaselove.github.io/431-2023" rel="" target="">
 <span class="menu-text">431 Homepage</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#we-will-post-full-instructions-before-our-first-class.-for-now-ignore-this-draft." id="toc-we-will-post-full-instructions-before-our-first-class.-for-now-ignore-this-draft." class="nav-link active" data-scroll-target="#we-will-post-full-instructions-before-our-first-class.-for-now-ignore-this-draft.">We will post full instructions before our first class. For now, ignore this draft.</a></li>
  <li><a href="#analysis-1-simple-linear-regression-model" id="toc-analysis-1-simple-linear-regression-model" class="nav-link" data-scroll-target="#analysis-1-simple-linear-regression-model">Analysis 1: Simple Linear Regression Model</a>
  <ul class="collapse">
  <li><a href="#the-variables" id="toc-the-variables" class="nav-link" data-scroll-target="#the-variables">The Variables</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research Question</a></li>
  <li><a href="#visualizing-the-data" id="toc-visualizing-the-data" class="nav-link" data-scroll-target="#visualizing-the-data">Visualizing the Data</a></li>
  <li><a href="#transformation-assessment" id="toc-transformation-assessment" class="nav-link" data-scroll-target="#transformation-assessment">Transformation Assessment</a>
  <ul class="collapse">
  <li><a href="#tips-on-the-transformation-assessment" id="toc-tips-on-the-transformation-assessment" class="nav-link" data-scroll-target="#tips-on-the-transformation-assessment">Tips on the Transformation Assessment</a></li>
  </ul></li>
  <li><a href="#the-fitted-model" id="toc-the-fitted-model" class="nav-link" data-scroll-target="#the-fitted-model">The Fitted Model</a></li>
  <li><a href="#residual-analysis" id="toc-residual-analysis" class="nav-link" data-scroll-target="#residual-analysis">Residual Analysis</a></li>
  <li><a href="#conclusions-and-limitations" id="toc-conclusions-and-limitations" class="nav-link" data-scroll-target="#conclusions-and-limitations">Conclusions and Limitations</a></li>
  </ul></li>
  <li><a href="#analysis-2-comparing-two-independent-samples" id="toc-analysis-2-comparing-two-independent-samples" class="nav-link" data-scroll-target="#analysis-2-comparing-two-independent-samples">Analysis 2: Comparing Two Independent Samples</a>
  <ul class="collapse">
  <li><a href="#analysis-2-specifications" id="toc-analysis-2-specifications" class="nav-link" data-scroll-target="#analysis-2-specifications">Analysis 2 Specifications</a></li>
  </ul></li>
  <li><a href="#analysis-3-comparing-an-outcome-in-2023-to-its-value-in-2018" id="toc-analysis-3-comparing-an-outcome-in-2023-to-its-value-in-2018" class="nav-link" data-scroll-target="#analysis-3-comparing-an-outcome-in-2023-to-its-value-in-2018">Analysis 3: Comparing An Outcome in 2023 to its value in 2018</a>
  <ul class="collapse">
  <li><a href="#analysis-3-specifications" id="toc-analysis-3-specifications" class="nav-link" data-scroll-target="#analysis-3-specifications">Analysis 3 Specifications</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project A Analyses</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>431 Staff </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023-08-21</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="we-will-post-full-instructions-before-our-first-class.-for-now-ignore-this-draft." class="level1">
<h1>We will post full instructions before our first class. For now, ignore this draft.</h1>
<p>Using the tibble you’ve developed following the instructions on the <a href="./data.html">Data</a> and <a href="./proposal.html">Proposal</a> pages, you will then create the remainder of your report by performing the analytic tasks specified below.</p>
<p>Each of these tasks should include R code that creates the information you need, <strong>and</strong> complete English sentences that interpret those results. Again, you have to be able to reason about what you’ve done, not just generate the code to solve the problem.</p>
</section>
<section id="analysis-1-simple-linear-regression-model" class="level1">
<h1>Analysis 1: Simple Linear Regression Model</h1>
<p>Provide evidence regarding the question of how well your Analysis 1 outcome can be predicted using your Analysis 1 predictor. This should include a report on the effectiveness of a simple linear regression model, and an appropriate plot of the relationship. Important steps to include in your analytic report include:</p>
<p>In your portfolio (section 12.1), you built (and will now edit) your careful statement of the <strong>research question</strong> you are trying to answer with this analysis. At the end of this Analysis, a clear and appropriate <strong>response</strong> to that research question is required, accompanied by a clear description of the limitations of your work.</p>
<ul>
<li>Most of the time, one model won’t let you come to a strong conclusion about a question of interest, and it is your job to accurately present what information can be specified as a result of the model, without overstating your conclusions.</li>
<li>This (the specification of your research question and your response) is the most important part of Analysis 1.</li>
</ul>
<p>You will need to build a visualization of the relationship between the outcome (Y-axis) and the predictor (X-axis) and a written description of what you learn about the association (which should include comments about its direction, shape and strength along with identification of any substantial outliers). You’ll also provide:</p>
<ul>
<li>A specification of any transformations you choose to apply to the X or Y variable in order to obtain a better fit with a simple linear regression, along with some justification for the choice (or for the decision not to apply a transformation.)</li>
<li>A specification of the actual prediction equation created by your linear model, and an interpretation of what the coefficients mean, and how they should be interpreted in light of their estimated standard errors.</li>
<li>A loess smooth and a linear model fit line as part of your plot.</li>
<li>A specification of summary measures of goodness of fit, at a minimum the residual standard deviation (sigma) and the r-squared value. The quality of fit is not a consideration in the grading of this work.</li>
<li>Identification of the two counties (by name and state) where the model is least successful at predicting the outcome.</li>
</ul>
<p>The rest of the material below forms an outline of Analysis 1.</p>
<section id="the-variables" class="level2">
<h2 class="anchored" data-anchor-id="the-variables">The Variables</h2>
<p>In this section you will build a simple linear regression model to predict your outcome using one of your two quantitative predictors (it’s your choice.) Start by identifying those variables, and restricting your data set for this analysis to the complete cases on those variables.</p>
<ul>
<li>Use complete English sentences to identify your outcome and your predictor, describing what each variable means and its units of measurement.</li>
<li>Also specify the name of each variable in your tibble (making it clear which is the outcome and which the predictor), the name of your tibble, which states you’re studying, and how many counties have complete data on both variables.</li>
<li>Finally, specify the values of your outcome and predictor for Cuyahoga County, in Ohio, where CWRU’s campus is located.</li>
</ul>
</section>
<section id="research-question" class="level2">
<h2 class="anchored" data-anchor-id="research-question">Research Question</h2>
<p>Here, you should restate your research question clearly, following the path set out in your proposal, tweaked as necessary in light of the work you’ve now completed. Remember that a research question will end with a question mark, and will be something you will be able to answer (or at least respond to effectively) after your analysis is complete.</p>
</section>
<section id="visualizing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-data">Visualizing the Data</h2>
<p>Provide an attractive, well-labeled scatterplot of your outcome and predictor, before any transformations, including all code necessary to build it, and describe what the plot tells you about the association of the variables, as detailed in the instructions.</p>
</section>
<section id="transformation-assessment" class="level2">
<h2 class="anchored" data-anchor-id="transformation-assessment">Transformation Assessment</h2>
<p>Here, you will provide information about any transformations you chose to apply to the outcome, and explain why you did (or didn’t) choose to use a transformation.</p>
<ul>
<li><p>If you decide to use a transformation, specify the transformation you’ve chosen carefully, and show the scatterplot of the transformed data, using the same suggestions as were provided in the previous section to describe the resulting plot. Write a few sentences describing the transformations you considered, and why you thought this was the most promising, and why you eventually decided to use the transformed versions of your variables.</p></li>
<li><p>If you decide <strong>not</strong> to use a transformation, identify the ONE plot which was the most promising of available transformations and show that one. Write a few sentences describing the transformations you considered, and why you thought this was the most promising, and why you eventually decided to stick with the original versions of the variables.</p></li>
</ul>
<section id="tips-on-the-transformation-assessment" class="level3">
<h3 class="anchored" data-anchor-id="tips-on-the-transformation-assessment">Tips on the Transformation Assessment</h3>
<p>Your response will include ONE plot demonstrating a particular transformation, although you will probably fit and view several plots in order to select a final one for this work.</p>
<p>For this part of Project A, confine your search to either a logarithm, an inverse, or a square as applied to the outcome. If you want to consider one of those transformations for the predictor as well, that’s OK but not crucial. You should select the most promising transformation on the basis of a scatterplot (perhaps with a loess smooth and linear fit) after the transformation has been applied.</p>
<p>You are discouraged from using numerical summaries of fit in this section. Of course, summary statistics like <span class="math inline">\(R^2\)</span> when the outcome is transformed will definitely not be comparable.</p>
</section>
</section>
<section id="the-fitted-model" class="level2">
<h2 class="anchored" data-anchor-id="the-fitted-model">The Fitted Model</h2>
<p>Fit your model to use your predictor to predict your outcome (applying your selected transformation) and provide the code you used, and the following summary elements in this section.</p>
<ol type="1">
<li><p>A written statement of the full prediction equation, with coefficients nicely rounded, and a careful description of what the coefficients mean in context.</p></li>
<li><p>A tidy summary of the model’s coefficients, including 90% confidence interval for model estimates.</p></li>
<li><p>The model’s R-squared, residual standard error, the number of observations to which the model was fit, and the Pearson correlation of your predictor and outcome.</p></li>
</ol>
</section>
<section id="residual-analysis" class="level2">
<h2 class="anchored" data-anchor-id="residual-analysis">Residual Analysis</h2>
<p>Here, you’ll need to do four things.</p>
<ol type="1">
<li>prepare a pair of residual plots (one to assess residuals vs.&nbsp;fitted values for non-linearity, and one to assess Normality in the residuals or the standardized residuals.)</li>
<li>interpret those plots in terms of what they tell you about how well the assumptions of linearity and Normality hold for your setting, in complete English sentences.</li>
<li>display your model’s prediction for the original (untransformed) outcome you are studying for Cuyahoga County, in Ohio, and compare it to Cuyahoga’s actual value of this outcome.</li>
<li>identify the two counties (by name and state) where the model you’ve fit is least successful at predicting the outcome (in the sense of having the largest residual in absolute value.)</li>
</ol>
<ul>
<li>The <code>augment</code> function would be very helpful here.</li>
<li>If you model is called <code>m1</code>, you could use something like <code>plot(m1, which = c(1:2))</code> to obtain these two plots and that’s OK.</li>
<li>You can produce a more pleasing picture using <code>ggplot2</code> and <code>patchwork</code> following the strategy I’ve demonstrated multiple times in the slides and the Course Notes, should you desire.</li>
</ul>
</section>
<section id="conclusions-and-limitations" class="level2">
<h2 class="anchored" data-anchor-id="conclusions-and-limitations">Conclusions and Limitations</h2>
<p>Here, you’ll write two paragraphs.</p>
<p>In the first paragraph, you should provide a clear restatement of your research question, followed by a clear and appropriate response to your research question, motivated by your results.</p>
<p>Then, write a paragraph which summarizes the key limitations of your work in Analysis 1. - If you see problems with regression assumptions in your residual plot, that would be a good thing to talk about here, for instance. - Another issue that is worth discussing is your target population, and what evidence you can describe that might indicate whether your selected states are a representative sample of the US as a whole, or perhaps some particular part of the United States.</p>
</section>
</section>
<section id="analysis-2-comparing-two-independent-samples" class="level1">
<h1>Analysis 2: Comparing Two Independent Samples</h1>
<p>Here, you have identified one quantitative (Analysis 2 outcome) and one categorical variable (Analysis 2 binary predictor.)</p>
<p>You’ll analyze the results and build a 90% confidence interval for the difference in means with an appropriate t-based or bootstrap procedure.</p>
<p>You will provide complete code, appropriate visualizations and detailed explanations of your analytic decisions, and conclusions.</p>
<p>We are looking for:</p>
<ul>
<li>Descriptive and exploratory summaries of the data across the two predictor groups for your chosen outcome, including, of course, attractive and well-constructed visualizations.</li>
<li>Comparisons of the population mean difference for your Analysis 2 outcome across a set of two groups defined by your Analysis 2 predictor, including appropriate demonstrations of the reasons behind the choices you made between parametric and bootstrap procedures.</li>
</ul>
<section id="analysis-2-specifications" class="level2">
<h2 class="anchored" data-anchor-id="analysis-2-specifications">Analysis 2 Specifications</h2>
<ul>
<li>Your Analysis 2 material should start with specifications of what each of the variables you are studying in this analysis actually mean, and how your sample was taken from the CHR 2023 data.</li>
<li>Your cleaning, creation of your groups and other data management activities should already have been shown in earlier sections. Please refer back to those and don’t repeat what you’ve already done. Be sure that the Codebook you provided describes both of the variables you are using in your analyses here.</li>
<li>Provide numerical summaries and visualizations of interest that are relevant to this analysis, and comment on any issues you observe.</li>
<li>For your main analysis, show your work and your reasoning (not just your code), and comment on any analytic decisions you make.</li>
<li>Be sure to actively present and justify any assumptions you are making.</li>
<li>Finally, answer your research question, by clearly linking the analytic results to what you were asking at the start.</li>
<li>If you can see a logical next step for the analysis of the question you asked, specify it. Also, if you specified a pre-existing belief about what would happen, reflect on that in light of the data.</li>
</ul>
</section>
</section>
<section id="analysis-3-comparing-an-outcome-in-2023-to-its-value-in-2018" class="level1">
<h1>Analysis 3: Comparing An Outcome in 2023 to its value in 2018</h1>
<p>Here, we have identified two quantitative variable (the same outcome in two different time periods) which are paired (so that they have a natural link between them, and use the same units of measurement.)</p>
<p>You’ll analyze the results and build a 90% confidence interval for the population mean difference with an appropriate t-based or bootstrap procedure.</p>
<p>Again, you will provide complete code, appropriate visualizations and detailed explanations of your analytic decisions, and conclusions.</p>
<section id="analysis-3-specifications" class="level2">
<h2 class="anchored" data-anchor-id="analysis-3-specifications">Analysis 3 Specifications</h2>
<ul>
<li>Your Analysis 3 material should start with specifications of what the outcome you are studying in this analysis actually means, and how your samples in 2018 and 2023 were created.</li>
<li>Your cleaning, creation of your groups and other data management activities should already have been shown in earlier sections. Please refer back to those and don’t repeat what you’ve already done. Be sure that the Codebook you provided describes both of the variables you are using in your analyses here.</li>
<li>Provide numerical summaries and visualizations of interest that are relevant to this analysis, and comment on any issues you observe.</li>
<li>For your main analysis, show your work and your reasoning (not just your code), and comment on any analytic decisions you make.</li>
<li>Be sure to actively present and justify any assumptions you are making.</li>
<li>Finally, answer your research question, by clearly linking the analytic results to what you were asking at the start.</li>
<li>If you can see a logical next step for the analysis of the question you asked, specify it. Also, if you specified a pre-existing belief about what would happen, reflect on that in light of the data.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>